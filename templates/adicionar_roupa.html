{% extends 'base.html' %}

{% block title %}Adicionar Roupa{% endblock %}

{% block content %}
<div class="container">
    <div class="container-interno">
        <h1>Adicionar Roupa</h1>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <p>
            <a href="{{ url_for('dashboard') }}">Painel de Controle</a> |
            <a href="{{ url_for('listar_roupas') }}">Listar Roupas</a>
        </p>
        <form method="POST" action="/adicionar_roupa">
            <!-- Campos ocultos para código do produto e data de entrada -->
            <input type="hidden" id="codigo_produto" name="codigo_produto">
            <input type="hidden" id="data_entrada" name="data_entrada">

            <div class="form-row">
                <label for="tipo_roupa">Tipo de Roupa</label>
                <select id="tipo_roupa" name="tipo_roupa" required>
                    <option value="Camiseta">Camiseta</option>
                    <option value="Camisa">Camisa</option>
                    <option value="Blusa">Blusa</option>
                    <option value="Regata">Regata</option>
                    <option value="Casaco">Casaco</option>
                    <option value="Blazer">Blazer</Calça>
                    <option value="Calça">Calça</option>
                    <option value="Saia">Saia</option>
                    <option value="Bermuda">Bermuda</option>
                    <option value="Pantalona">Pantalona</option>
                    <option value="Vestido">Vestido</option>
                    <option value="Macacão">Macacão</option>
                    <option value="Jardineira">Jardineira</option>
                    <option value="Lingerie">Lingerie</option>
                    <option value="Cueca">Cueca</option>
                    <option value="Meia">Meia</option>
                    <option value="Roupa de banho">Roupa de banho</option>
                    <option value="Roupa de dormir">Roupa de dormir</option>
                    <option value="Roupa esportiva">Roupa esportiva</option>
                    <option value="Black-tie (Traje de Gala)">Black-tie (Traje de Gala)</option>
                    <option value="White-tie (Formal)">White-tie (Formal)</option>
                </select>
                <label for="tecido">Tecido</label>
                <select id="tecido" name="tecido" required>
                    <option value="Algodão">Algodão</option>
                    <option value="Algodão e Poliéster">Algodão e Poliéster</option>
                    <option value="Linho">Linho</option>
                    <option value="Seda">Seda</option>
                    <option value="Lã">Lã</option>
                    <option value="Veludo">Veludo</option>
                    <option value="Viscose">Viscose</Calça>
                    <option value="Cupro">Cupro</option>
                    <option value="Tencel">Tencel</option>
                    <option value="Poliéster">Poliéster</option>
                    <option value="Nylon">Nylon</option>
                    <option value="Elastano">Elastano</option>
                    <option value="Microfibra">Microfibra</option>
                    <option value="Cetim">Cetim</option>
                    <option value="Suede">Suede</option>
                    <option value="Cupro">Cupro</option>
                    <option value="Couro">Couro</option>
                    <option value="Jeans">Jeans</option>
                </select>
            </div>
            <div class="form-row">
                <label for="quantidade">Quantidade de Roupas</label>
                <input type="number" id="quantidade" name="quantidade" required />
            </div>
            <div>
                <label for="preco-unitario">Preço Unitário</label>
                <input type="text" id="preco_unitario" name="preco_unitario" required oninput="formatarMoeda(this)" />
            </div>
            <div class="form-row">
                <label for="cor">Cor da Roupa</label>
                <input type="text" id="cor" name="cor" required>
            </div>
           <div class="form-row">
                <label for="tamanhos">Tamanhos</label>
                <select id="tamanhos" name="tamanhos" multiple required>
                    <option value="P">P</option>
                    <option value="M">M</option>
                    <option value="G">G</option>
                    <option value="GG">GG</option>
                    <option value="XG">XG</option>
                    <option value="XGG">XGG</option>
                    <option value="40">40</option>
                    <option value="41">41</option>
                    <option value="42">42</option>
                    <option value="43">43</option>
                    <option value="44">44</option>
                    <option value="45">45</option>
                    <option value="46">46</option>
                    <option value="47">47</option>
                    <option value="48">48</option>
                    <option value="49">49</option>
                    <option value="50">50</option>
                    <option value="51">51</option>
                    <option value="52">52</option>
                    <option value="53">53</option>
                    <option value="40">40</option>
                    <option value="41">41</option>
                    <option value="42">42</option>
                    <option value="43">43</option>
                    <option value="44">44</option>
                    <option value="45">45</option>
                    <option value="46">46</option>
                    <option value="47">47</option>
                    <option value="48">48</option>
                    <option value="49">49</option>
                    <option value="50">50</option>
                    <option value="51">51</option>
                    <option value="52">52</option>
                    <option value="53">53</option>
                    <option value="54">54</option>
                    <option value="55">55</option>
                    <option value="56">56</option>
                    <option value="57">57</option>
                    <option value="58">58</option>
                    <option value="59">59</option>
                    <option value="60">60</option>
                    <option value="61">61</option>
                    <option value="62">62</option>
                    <option value="63">63</option>
                    <option value="64">64</option>
                    <option value="65">65</option>
                    <option value="66">66</option>
                    <option value="67">67</option>
                    <option value="68">68</option>
                    <option value="69">69</option>
                    <option value="70">70</option>
                    <option value="71">71</option>
                    <option value="72">72</option>
                    <option value="73">73</option>
                    <option value="74">74</option>
                    <option value="75">75</option>
                    <option value="76">76</option>
                    <option value="77">77</option>
                    <option value="78">78</option>
                    <option value="79">79</option>
                    <option value="80">80</option>
                    <option value="81">81</option>
                    <option value="82">82</option>
                    <option value="83">83</option>
                    <option value="84">84</option>
                    <option value="85">85</option>
                    <option value="86">86</option>
                    <option value="87">87</option>
                    <option value="88">88</option>
                    <option value="89">89</option>
                    <option value="90">90</option>
                    <option value="91">91</option>
                    <option value="92">92</option>
                    <option value="93">93</option>
                    <option value="94">94</option>
                    <option value="95">95</option>
                    <option value="96">96</option>
                    <option value="97">97</option>
                    <option value="98">98</option>
                    <option value="99">99</option>
                    <option value="100">100</option>
                </select>
            </div>
            <div class="form-row" style="border-top: 2px dotted var(--cinza-medio);">
                <label>Detalhes da Roupa?</label>
                <input type="radio" id="detalhes_nao" name="detalhes_radio" value="nao" checked>
                <label for="detalhes_nao">Não</label>
                <input type="radio" id="detalhes_sim" name="detalhes_radio" value="sim">
                <label for="detalhes_sim">Sim</label>
            </div>
            <div class="form-row" id="detalhes_texto" style="display: none;">
                <label for="detalhes">Detalhes</label>
                <textarea id="detalhes" name="detalhes"></textarea>
            </div>
            <input type="submit" value="Adicionar Roupa" />
        </form>
    </div>
</div>
<script>
// Seleciona os elementos de rádio "Sim" e "Não" para os detalhes da roupa e o campo de texto dos detalhes.
    const detalhesSim = document.getElementById('detalhes_sim');
    const detalhesNao = document.getElementById('detalhes_nao');
    const detalhesTexto = document.getElementById('detalhes_texto');

    // Adiciona um listener para o evento de mudança no rádio "Sim".
    detalhesSim.addEventListener('change', function() {
        // Se o rádio "Sim" está selecionado...
        if (this.checked) {
            // ...mostra o campo de texto dos detalhes.
            detalhesTexto.style.display = 'block';
        }
    });

    // Adiciona um listener para o evento de mudança no rádio "Não".
    detalhesNao.addEventListener('change', function() {
        // Se o rádio "Não" está selecionado...
        if (this.checked) {
            // ...esconde o campo de texto dos detalhes.
            detalhesTexto.style.display = 'none';
        }
    });

    // Preenche os campos de código do produto e data de entrada automaticamente quando a página é carregada.
    document.addEventListener('DOMContentLoaded', function() {
        // Cria um novo objeto Date com a data e hora atuais.
        const now = new Date();
        // Formata a data e hora para gerar um código de produto único.
        const codigoProduto = now.toISOString().slice(0,10).replace(/-/g,"") + "-" + now.toISOString().slice(11,19).replace(/:/g,"");
        // Formata a data e hora para exibição no campo de data de entrada.
        const dataEntrada = now.toLocaleDateString('pt-BR') + ' - ' + now.toLocaleTimeString('pt-BR');

        // Define os valores dos campos de código do produto e data de entrada com os valores gerados.
        document.getElementById('codigo_produto').value = codigoProduto;
        document.getElementById('data_entrada').value = dataEntrada;
    });

   function formatarMoeda(input) {
        let valor = input.value;
        valor = valor.replace(/\D/g, "");
        valor = valor.padStart(1, '0');
        valor = valor.slice(0, -2) + '.' + valor.slice(-2);
        input.value = valor;
    }
</script>
{% endblock %}
